select(-description)%>%
pivot_longer( names_to = strain, values_to = mutations)
pivot_longer( cols = c(2:ncols(.),names_to = strain, values_to = mutations)
#transpose the table to add the meta data
mXg %>%
#transpose the table to add the meta data
mXg %>%
pivot_longer( cols = c(2:ncols(.),names_to = strain, values_to = mutations)
#transpose the table to add the meta data
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncols(.),names_to = strain, values_to = mutations))
#transpose the table to add the meta data
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.),names_to = strain, values_to = mutations))
#transpose the table to add the meta data
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.),names_to = "strain", values_to = "mutations"))
#transpose the table to add the meta data
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.),names_to = "strain", values_to = "mutations"))
#transpose the table to add the meta data
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.),names_to = "aa", values_to = "mutations"))
#transpose the table to add the meta data
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "aa", values_to = "mutations")
#transpose the table to add the meta data
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain", values_to = "mutations")
#transpose the table to add the meta data
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain", values_to = "mutations")%>%
pivot_wider(names_from = "gene")
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain", values_to = "mutations")
#transpose the table to add the meta data
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain", values_to = "mutations")%>%
pivot_wider(id_cols = strain, names_from = "gene", values_from = "mutations")
select(strains,trt, lim, strain_ID)
#transpose the table and add the meta data
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
left_join(select(strains,trt, lim), . )
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")
#transpose the table and add the meta data
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
left_join(select(strains,trt, lim, strain_ID), . )
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
summarize_if(is.numeric, sum, na.rm = TRUE)
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
summarize(n=n())
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n=n())
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n=n())
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n=n())%>%
summarize_if(is.numeric, sum, na.rm = TRUE)
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n=n())%>%
summarize_if(is_double, sum, na.rm = TRUE)
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n=n())%>%
summarize_if(is_double, sum, na.rm = TRUE)
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n=n())%>%
group_by(n)
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n=n())%>%
group_by(n)%>%
summarize_if(is_double, sum, na.rm = TRUE)
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n=n())%>%
group_by(trt, lim,n)%>%
summarize_if(is_double, sum, na.rm = TRUE)
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(trt,".",lim,".","n", n.strains))
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))%>%
pivot_longer( cols = c(3:ncol(.)-1),names_to = "gene", values_to = "mutations")
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))%>%
pivot_longer( cols = c(4:ncol(.)-1),names_to = "gene", values_to = "mutations")
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))%>%
pivot_longer( cols = c(4:(ncol(.)-1)),names_to = "gene", values_to = "mutations")
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))%>%
pivot_longer( cols = c(4:(ncol(.)-1)),names_to = "gene", values_to = "mutations")%>%
pivot_wider(id_cols = meta, names_from = "meta", values_from = "mutations")%>%
gather("strain", "mutation", 2:ncol(.)) #%>%
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))%>%
pivot_longer( cols = c(4:(ncol(.)-1)),names_to = "gene", values_to = "mutations")%>%
pivot_wider(id_cols = meta, names_from = "meta", values_from = "mutations")
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))%>%
pivot_longer( cols = c(4:(ncol(.)-1)),names_to = "gene", values_to = "mutations")%>%
pivot_wider(id_cols = c(trt, lim,n.strains), names_from = "meta", values_from = "mutations")
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))%>%
pivot_longer( cols = c(4:(ncol(.)-1)),names_to = "gene", values_to = "mutations")%>%
pivot_wider(id_cols = c(trt, lim,n.strains), names_from = "gene", values_from = "mutations")
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))%>%
pivot_longer( cols = c(4:(ncol(.)-1)),names_to = "gene", values_to = "mutations")%>%
pivot_wider(id_cols = meta, names_from = "gene", values_from = "mutations")
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))#%>%
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))%>%
select(-trt,-lim,-n.strains)
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))%>%
select(is_numeric)
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))%>%
select_if(is_numeric)
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))#%>%
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))%>%
select(-trt)
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))%>%
ungroup()%>%
select(-trt)
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))%>%
ungroup()%>%
select(-trt, -lim, -n.strains)
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))%>%
ungroup()%>%
select(-trt, -lim, -n.strains)%>%
pivot_longer( cols = c(1:(ncol(.)-1)),names_to = "gene", values_to = "mutations")#%>%
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))%>%
ungroup()%>%
select(-trt, -lim, -n.strains)%>%
pivot_longer( cols = c(1:(ncol(.)-1)),names_to = "gene", values_to = "mutations")%>%
pivot_wider(id_cols = gene, names_from = "mets", values_from = "mutations")
#transpose the table
mXg %>%
select(-description)%>%
pivot_longer( cols = c(2:ncol(.)),names_to = "strain_ID", values_to = "mutations")%>%
pivot_wider(id_cols = strain_ID, names_from = "gene", values_from = "mutations")%>%
# add the meta data
left_join(select(strains,trt, lim, strain_ID), . )%>%
#summarize treatments
group_by(trt, lim)%>%
mutate(n.strains=n())%>%
group_by(trt, lim,n.strains)%>%
summarize_if(is_double, sum, na.rm = TRUE)%>%
# transpose back
mutate(meta=paste0(lim,".",trt,".","n", n.strains))%>%
ungroup()%>%
select(-trt, -lim, -n.strains)%>%
pivot_longer( cols = c(1:(ncol(.)-1)),names_to = "gene", values_to = "mutations")%>%
pivot_wider(id_cols = gene, names_from = "meta", values_from = "mutations")
